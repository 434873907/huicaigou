(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a95d3508"],{"1c6d":function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"buy-limit-detail"},[e("h2",{staticClass:"big-title"},[t._v("编辑活动")]),e("div",{staticClass:"wrap"},[e("div",{staticClass:"form-wrap"},[e("div",{staticClass:"form-name"},[t._v("活动时间:")]),e("el-date-picker",{staticClass:"timepicker-control",attrs:{size:"small",type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择开始时间"},model:{value:t.detailData.startTime,callback:function(a){t.$set(t.detailData,"startTime",a)},expression:"detailData.startTime"}}),e("el-date-picker",{staticClass:"timepicker-control",attrs:{size:"small",type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择结束时间"},model:{value:t.detailData.endTime,callback:function(a){t.$set(t.detailData,"endTime",a)},expression:"detailData.endTime"}})],1),e("div",{staticClass:"form-wrap"},[e("div",{staticClass:"form-name"},[t._v("活动商品:")]),e("a",{staticClass:"select-goods",on:{click:function(a){t.showGoodsModal=!0}}},[t._v("+ 选择商品")])]),e("div",{staticClass:"form-wrap"},[e("div",{staticClass:"form-name"},[t._v("货币:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.detailData.currency,expression:"detailData.currency"}],staticClass:"form-control",class:{"unset-select":!t.detailData.currency},on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,function(t){return t.selected}).map(function(t){var a="_value"in t?t._value:t.value;return a});t.$set(t.detailData,"currency",a.target.multiple?e:e[0])}}},[e("option",{domProps:{value:0}},[t._v("请选择")]),t._l(t.currencyList,function(a){return e("option",{key:a.code,domProps:{value:a.code}},[t._v(t._s(a.mixName))])})],2)]),t._m(0),e("div",{staticClass:"goods-list"},[e("table",{staticClass:"table"},[e("thead",[e("tr",[e("th",{staticClass:"w300"},[t._v("商品名称")]),e("th",{directives:[{name:"show",rawName:"v-show",value:!t.userConfig.singleChannel,expression:"!userConfig.singleChannel"}],staticClass:"w100"},[t._v("渠道")]),e("th",{staticClass:"w200"},[t._v("SKU")]),e("th",{staticClass:"w100"},[t._v("原价")]),e("th",[t._v("库存")]),e("th",[t._v("抢购价")]),e("th",[t._v("限购")]),e("th",[t._v("操作")])])]),e("tbody",t._l(t.detailData.activityItems,function(a,i){return e("tr",{key:i},[e("td",[e("img",{staticClass:"itemImg",attrs:{src:a.itemImg}}),e("span",{staticClass:"itemTitle"},[t._v(t._s(a.itemTitle))])]),e("td",{directives:[{name:"show",rawName:"v-show",value:!t.userConfig.singleChannel,expression:"!userConfig.singleChannel"}]},[t._v(t._s(a.channelName))]),e("td",[t._v(t._s(a.spec))]),e("td",[t._v(t._s(a.oriPrice))]),e("td",[t._v(t._s(a.stock))]),e("td",[e("ApiInput",{model:{value:a.flashSalePrice,callback:function(e){t.$set(a,"flashSalePrice",e)},expression:"item.flashSalePrice"}})],1),e("td",[e("ApiInput",{model:{value:a.num,callback:function(e){t.$set(a,"num",e)},expression:"item.num"}})],1),e("td",[e("a",{directives:[{name:"show",rawName:"v-show",value:0!=i,expression:"itemIndex != 0"}],staticClass:"link",on:{click:function(a){return t.moveItem(i)}}},[t._v("上移")]),e("a",{directives:[{name:"show",rawName:"v-show",value:i!=t.detailData.activityItems.length-1,expression:"itemIndex != detailData.activityItems.length-1"}],staticClass:"link",on:{click:function(a){return t.moveItem(i,1)}}},[t._v("下移")]),e("a",{staticClass:"link",on:{click:function(e){return t.deleteItem(a)}}},[t._v("删除")])])])}),0)])]),e("div",{staticClass:"form-wrap"},[e("div",{staticClass:"form-name form-disable"},[t._v("禁用优惠券:")]),e("el-radio",{attrs:{name:"disabled",label:1},model:{value:t.detailData.isDisableCoupon,callback:function(a){t.$set(t.detailData,"isDisableCoupon",a)},expression:"detailData.isDisableCoupon"}},[t._v("是")]),e("el-radio",{attrs:{name:"disabled",label:0},model:{value:t.detailData.isDisableCoupon,callback:function(a){t.$set(t.detailData,"isDisableCoupon",a)},expression:"detailData.isDisableCoupon"}},[t._v("否")])],1),e("div",{staticClass:"btn-main",on:{click:function(a){return t.save()}}},[t._v("保存")])]),t.showGoodsModal?e("selectActGoods",{on:{dialogGoods:t.dialogGoods,dialogGoodsCancel:t.dialogGoodsCancel}}):t._e()],1)},s=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"form-wrap"},[e("div",{staticClass:"form-name"},[t._v("商品信息:")])])}],l=(e("7f7f"),e("ac6a"),e("7994")),n={components:{selectActGoods:l["a"]},data:function(){return{showGoodsModal:!1,isDisabled:1,currencyList:[],detailData:{startTime:"",endTime:"",currency:0,isDisableCoupon:1,activityItems:[]}}},created:function(){var t=this,a=this.$route.params.id;this.getCurrency(),a&&this.api.activity.getBuyLimit({activityId:a}).then(function(a){t.detailData=a.data,t.detailData.activityItems=t.detailData.activityItems||[]})},methods:{getCurrency:function(){var t=this;this.api.common.currency({}).then(function(a){t.currencyList=a.data,t.currencyList.forEach(function(t){t.mixName=t.symbol+" "+t.name})})},dialogGoods:function(t){var a=this;if(t.goodsList&&t.goodsList.length>0){var e={};this.detailData.activityItems.forEach(function(t){e[t.itemId]=!0}),t.goodsList.forEach(function(t){t.selectedSku.forEach(function(i){var s={itemId:t.itemId,itemTitle:t.itemName,itemImg:t.mainImg,channelName:t.selectedChannelName,spec:"",stock:0,channelType:t.selectedChannel,flashSalePrice:"",num:""};s.stock+=i.stockNum,s.skuId=i.skuId,s.spec=i.skuValue,s.oriPrice="￥"+i.price,e[s.itemId]?a.$message.info({message:"商品‘".concat(s.itemTitle,"’重复"),showClose:!0}):a.detailData.activityItems.push(s)})})}this.showGoodsModal=!1},dialogGoodsCancel:function(){this.showGoodsModal=!1},save:function(){var t=this,a="addBuyLimit";this.detailData.activityId&&(a="updateBuyLimit"),this.detailData.participateItemNum=JSON.stringify(this.detailData.activityItems),this.api.activity[a](this.detailData).then(function(a){t.$message.success({message:a.message,showClose:!0}),t.$router.push({name:"限时抢购"})}).catch(function(a){console.log(t.detailData.activityItems),t.$message.warning({message:a.message,showClose:!0})})},deleteItem:function(t){var a=[];this.detailData.activityItems.map(function(e){e.itemId!=t.itemId&&a.push(e)}),this.detailData.activityItems=a},moveItem:function(t,a){var e=this.copy(this.detailData.activityItems[t]),i=t+(a?1:-1),s=this.copy(this.detailData.activityItems[i]);this.$set(this.detailData.activityItems,t,s),this.$set(this.detailData.activityItems,i,e)}}},o=n,c=(e("2812"),e("2877")),r=Object(c["a"])(o,i,s,!1,null,null,null);a["default"]=r.exports},2812:function(t,a,e){"use strict";var i=e("c728"),s=e.n(i);s.a},c728:function(t,a,e){}}]);
//# sourceMappingURL=chunk-a95d3508.bf937e11.js.map