(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4b6fc2be"],{"033d":function(t,a,e){},"44fe":function(t,a,e){"use strict";var i=e("033d"),s=e.n(i);s.a},"92ae":function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"presell-detail"},[e("h2",{staticClass:"big-title"},[t._v("编辑活动")]),e("div",{staticClass:"wrap"},[e("div",{staticClass:"form-wrap"},[e("div",{staticClass:"form-name"},[t._v("活动名称:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.detailData.name,expression:"detailData.name"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.detailData.name},on:{input:function(a){a.target.composing||t.$set(t.detailData,"name",a.target.value)}}})]),e("div",{staticClass:"form-wrap"},[e("div",{staticClass:"form-name"},[t._v("定金支付时间:")]),e("el-date-picker",{staticClass:"timepicker-control",attrs:{size:"small",type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择开始时间"},model:{value:t.detailData.depositStartTime,callback:function(a){t.$set(t.detailData,"depositStartTime",a)},expression:"detailData.depositStartTime"}}),e("el-date-picker",{staticClass:"timepicker-control",attrs:{size:"small",type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择结束时间"},model:{value:t.detailData.depositEndTime,callback:function(a){t.$set(t.detailData,"depositEndTime",a)},expression:"detailData.depositEndTime"}})],1),e("div",{staticClass:"form-wrap"},[e("div",{staticClass:"form-name"},[t._v("尾款支付时间:")]),e("el-date-picker",{staticClass:"timepicker-control",attrs:{size:"small",type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择开始时间"},model:{value:t.detailData.tailStartTime,callback:function(a){t.$set(t.detailData,"tailStartTime",a)},expression:"detailData.tailStartTime"}}),e("el-date-picker",{staticClass:"timepicker-control",attrs:{size:"small",type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择结束时间"},model:{value:t.detailData.tailEndTime,callback:function(a){t.$set(t.detailData,"tailEndTime",a)},expression:"detailData.tailEndTime"}})],1),e("div",{staticClass:"form-wrap"},[e("div",{staticClass:"form-name"},[t._v("活动商品:")]),e("a",{staticClass:"select-goods",on:{click:function(a){t.showGoodsModal=!0}}},[t._v("+ 选择商品")]),e("span",{staticClass:"form-tip"},[t._v("(仅添加设置为预售商品，非预售商品无法参加此活动)")])]),t._m(0),e("div",{staticClass:"goods-list"},[e("table",{staticClass:"table"},[e("thead",[e("tr",[e("th",{staticClass:"w300"},[t._v("商品名称")]),e("th",{directives:[{name:"show",rawName:"v-show",value:!t.userConfig.singleChannel,expression:"!userConfig.singleChannel"}],staticClass:"w150"},[t._v("渠道")]),e("th",{staticClass:"w150"},[t._v("SKU")]),e("th",{staticClass:"w100"},[t._v("商品价格")]),e("th",{staticClass:"w100"},[t._v("库存")]),e("th",{staticClass:"w100"},[t._v("限售")]),e("th",[t._v("操作")])])]),t._l(t.itemData,function(a,i){return e("tbody",{key:i},t._l(a.skuInfoList,function(i,s){return e("tr",{key:s},[0==s?e("td",{staticClass:"item-name",attrs:{rowspan:a.skuInfoList.length+1}},[e("img",{attrs:{src:a.mainImg}}),e("span",[e("a",[t._v(t._s(a.itemName))])])]):t._e(),e("td",{directives:[{name:"show",rawName:"v-show",value:!t.userConfig.singleChannel,expression:"!userConfig.singleChannel"}],attrs:{rowspan:a.skuInfoList.length+1}},[t._v(t._s(t.itemData.channelName))]),e("td",[t._v(t._s(i.skuValue))]),e("td",[t._v(t._s(i.price))]),e("td",[t._v(t._s(i.stockNum))]),e("td",[e("ApiInput",{model:{value:i.limitNum,callback:function(a){t.$set(i,"limitNum",a)},expression:"val.limitNum"}})],1),e("td",[e("a",{staticClass:"link",on:{click:function(e){return t.removeSku(s,a.itemName)}}},[t._v("删除")])])])}),0)})],2)]),e("div",{staticClass:"form-wrap"},[e("div",{staticClass:"form-name"},[t._v("货币:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.detailData.currency,expression:"detailData.currency"}],staticClass:"form-control",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,function(t){return t.selected}).map(function(t){var a="_value"in t?t._value:t.value;return a});t.$set(t.detailData,"currency",a.target.multiple?e:e[0])}}},[e("option",{domProps:{value:0}},[t._v("请选择")]),t._l(t.currencyList,function(a){return e("option",{key:a.code,domProps:{value:a.code}},[t._v(t._s(a.mixName))])})],2)]),e("div",{staticClass:"form-wrap"},[e("div",{staticClass:"form-name"},[t._v("定金金额:")]),e("ApiInput",{model:{value:t.detailData.depositAmount,callback:function(a){t.$set(t.detailData,"depositAmount",a)},expression:"detailData.depositAmount"}})],1),e("div",{staticClass:"form-wrap"},[e("div",{staticClass:"form-name"},[t._v("尾款金额:")]),e("ApiInput",{model:{value:t.detailData.tailAmount,callback:function(a){t.$set(t.detailData,"tailAmount",a)},expression:"detailData.tailAmount"}})],1),e("div",{staticClass:"form-wrap"},[e("div",{staticClass:"form-name"},[t._v("是否限购:")]),e("el-radio",{attrs:{name:"disabled",label:1},model:{value:t.detailData.limit,callback:function(a){t.$set(t.detailData,"limit",a)},expression:"detailData.limit"}},[t._v("是")]),e("el-radio",{attrs:{name:"disabled",label:0},model:{value:t.detailData.limit,callback:function(a){t.$set(t.detailData,"limit",a)},expression:"detailData.limit"}},[t._v("否")])],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.detailData.limit,expression:"detailData.limit"}],staticClass:"form-wrap"},[e("div",{staticClass:"form-name"},[t._v("限购数量:")]),e("ApiInput",{model:{value:t.detailData.limitNum,callback:function(a){t.$set(t.detailData,"limitNum",a)},expression:"detailData.limitNum"}})],1),e("div",{staticClass:"form-wrap"},[e("div",{staticClass:"form-name form-name-long"},[t._v("活动结束后商品:")]),e("el-radio",{attrs:{name:"disabled",label:1},model:{value:t.detailData.statusAfterAct,callback:function(a){t.$set(t.detailData,"statusAfterAct",a)},expression:"detailData.statusAfterAct"}},[t._v("正常销售")]),e("el-radio",{attrs:{name:"disabled",label:0},model:{value:t.detailData.statusAfterAct,callback:function(a){t.$set(t.detailData,"statusAfterAct",a)},expression:"detailData.statusAfterAct"}},[t._v("自动下架")])],1),e("div",{staticClass:"btn-main",on:{click:function(a){return t.save()}}},[t._v("保存")])]),t.showGoodsModal?e("selectActGoods",{attrs:{presell:1},on:{dialogGoods:t.dialogGoods,dialogGoodsCancel:t.dialogGoodsCancel}}):t._e()],1)},s=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"form-wrap"},[e("div",{staticClass:"form-name"},[t._v("商品信息:")])])}],l=(e("7f7f"),e("ac6a"),e("7994")),o={components:{selectActGoods:l["a"]},data:function(){return{showGoodsModal:!1,isDisabled:1,currencyList:[],itemData:{},detailData:{name:"",depositStartTime:"",depositEndTime:"",tailStartTime:"",tailEndTime:"",itemId:"",skuSellLimit:"",channelType:"",currency:0,depositAmount:"",tailAmount:"",limit:0,limitNum:"",statusAfterAct:""}}},created:function(){var t=this,a=this.$route.params.id;this.getCurrency(),a&&this.api.presell.get({id:a}).then(function(a){t.detailData=a.data,t.detailData.itemId=a.data.itemInfo.itemId,t.itemData[a.data.itemInfo.itemName]=a.data.itemInfo})},methods:{getCurrency:function(){var t=this;this.api.common.currency({}).then(function(a){t.currencyList=a.data,t.currencyList.forEach(function(t){t.mixName=t.symbol+" "+t.name})})},dialogGoods:function(t){var a=this,e=0;for(var i in this.itemData)e++;e>=1?this.$message.error({message:"不能修改活动信息",showClose:!0}):t.goodsList.forEach(function(t){a.detailData.itemId=t.itemId,a.detailData.skuSellLimit=[],a.detailData.channelType=t.selectedChannel,t.selectedSku.forEach(function(e){a.itemData[t.itemName]=a.itemData[t.itemName]?a.itemData[t.itemName]:{},a.itemData[t.itemName].skuInfoList=a.itemData[t.itemName].skuInfoList?a.itemData[t.itemName].skuInfoList:[],a.itemData[t.itemName].skuInfoList.push({skuId:e.skuId,skuValue:e.skuValue,stockNum:e.stockNum,price:e.price,limitNum:""})}),a.itemData[t.itemName].channelType=t.selectedChannel,a.itemData[t.itemName].channelName=t.selectedChannelName,a.itemData[t.itemName].itemId=t.itemId,a.itemData[t.itemName].itemName=t.itemName,a.itemData[t.itemName].mainImg=t.mainImg}),this.showGoodsModal=!1},dialogGoodsCancel:function(){this.showGoodsModal=!1},removeSku:function(t,a){this.itemData[a].skuInfoList.splice(t,1),this.$forceUpdate()},save:function(){var t=this,a="add";for(var e in this.detailData.id&&(a="update"),this.detailData.skuSellLimit=[],this.itemData)this.itemData[e].skuInfoList.forEach(function(a){t.detailData.skuSellLimit.push({skuId:a.skuId,limitNum:a.limitNum})});this.detailData.limitNum=this.detailData.limitNum||0,this.detailData.skuSellLimit=JSON.stringify(this.detailData.skuSellLimit),this.api.presell[a](this.detailData).then(function(){t.$message.success({message:"成功",showClose:!0}),t.$router.push({path:"/center/marketing/presell"})})}}},n=o,m=(e("44fe"),e("2877")),d=Object(m["a"])(n,i,s,!1,null,null,null);a["default"]=d.exports}}]);
//# sourceMappingURL=chunk-4b6fc2be.a29548f3.js.map