(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2517879c"],{"014d":function(a,e,t){},4620:function(a,e,t){"use strict";var n=t("014d"),s=t.n(n);s.a},5739:function(a,e,t){"use strict";t.r(e);var n=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"banner-detail"},[t("h2",{staticClass:"title"},[a._v(a._s(a.id?"编辑":"新增")+"banner")]),t("div",{staticClass:"banner-wrap"},[t("div",{staticClass:"banner-item"},[t("span",{staticClass:"banner-title"},[a._v("标题")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.bannerParams.title,expression:"bannerParams.title"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:a.bannerParams.title},on:{input:function(e){e.target.composing||a.$set(a.bannerParams,"title",e.target.value)}}})]),t("div",{staticClass:"banner-item"},[t("span",{staticClass:"banner-title"},[a._v("图片上传")]),t("img",{directives:[{name:"show",rawName:"v-show",value:a.bannerParams.imageUrl,expression:"bannerParams.imageUrl"}],staticClass:"imageUrl",attrs:{src:a.bannerParams.imageUrl}}),t("a",{directives:[{name:"show",rawName:"v-show",value:!a.bannerParams.imageUrl,expression:"!bannerParams.imageUrl"}],staticClass:"upload-img",attrs:{href:"javascript:;"},on:{click:function(e){return a.openCropperModal()}}},[a._v("点击上传图片")]),t("a",{directives:[{name:"show",rawName:"v-show",value:a.bannerParams.imageUrl,expression:"bannerParams.imageUrl"}],staticClass:"link",on:{click:function(e){return a.openCropperModal()}}},[a._v("更改海报")]),t("span",{directives:[{name:"show",rawName:"v-show",value:!a.bannerParams.imageUrl,expression:"!bannerParams.imageUrl"}],staticClass:"tips"},[a._v("建议尺寸:1920x500")])]),t("div",{staticClass:"banner-item"},[t("span",{staticClass:"banner-title"},[a._v("跳转至")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.bannerParams.jumpType,expression:"bannerParams.jumpType"}],staticClass:"form-control",on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,function(a){return a.selected}).map(function(a){var e="_value"in a?a._value:a.value;return e});a.$set(a.bannerParams,"jumpType",e.target.multiple?t:t[0])}}},a._l(a.jumpTypeList,function(e){return t("option",{key:e.id,domProps:{value:e.id}},[a._v(a._s(e.name))])}),0)]),t("div",{directives:[{name:"show",rawName:"v-show",value:25===a.bannerParams.jumpType,expression:"bannerParams.jumpType===25"}],staticClass:"banner-item"},[t("span",{staticClass:"banner-title"},[a._v("活动ID")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.bannerParams.jumpData,expression:"bannerParams.jumpData"}],staticClass:"form-control",attrs:{type:"text",placeholder:"请输入活动ID"},domProps:{value:a.bannerParams.jumpData},on:{input:function(e){e.target.composing||a.$set(a.bannerParams,"jumpData",e.target.value)}}})]),t("div",{directives:[{name:"show",rawName:"v-show",value:24===a.bannerParams.jumpType,expression:"bannerParams.jumpType===24"}],staticClass:"banner-item"},[t("span",{staticClass:"banner-title"},[a._v("链接地址")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.bannerParams.jumpData,expression:"bannerParams.jumpData"}],staticClass:"form-control",attrs:{type:"text",placeholder:"请输入跳转地址"},domProps:{value:a.bannerParams.jumpData},on:{input:function(e){e.target.composing||a.$set(a.bannerParams,"jumpData",e.target.value)}}})]),t("div",{directives:[{name:"show",rawName:"v-show",value:110===a.bannerParams.jumpType,expression:"bannerParams.jumpType===110"}],staticClass:"banner-item"},[t("span",{staticClass:"banner-title"},[a._v("关键字")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.bannerParams.jumpData,expression:"bannerParams.jumpData"}],staticClass:"form-control",attrs:{type:"text",placeholder:"关键字"},domProps:{value:a.bannerParams.jumpData},on:{input:function(e){e.target.composing||a.$set(a.bannerParams,"jumpData",e.target.value)}}})]),t("div",{directives:[{name:"show",rawName:"v-show",value:31===a.bannerParams.jumpType,expression:"bannerParams.jumpType===31"}],staticClass:"group-content"},a._l(a.bannerParams.conditionList,function(e,n){return t("div",{key:n+"banner",staticClass:"banner-item"},[t("span",{staticClass:"banner-title"},[a._v(a._s(0===n?"组合条件":""))]),t("div",{staticClass:"item-condition"},[t("div",{staticClass:"condition-row"},[t("span",{staticClass:"condition-title"},[a._v("类目")]),t("a",{staticClass:"btn-fill-main",on:{click:function(t){return a.selectItemCate(e,n)}}},[a._v("选择类目")]),a._l(e.cateList,function(s,i){return t("span",{key:i+"cate"+n,staticClass:"btn-small"},[a._v("\n              "+a._s(s.name)),t("a",{staticClass:"delete-icon",on:{click:function(t){return a.removeItemCate(e,i)}}},[a._v("X")])])})],2),t("div",{staticClass:"condition-row"},[t("span",{staticClass:"condition-title"},[a._v("品牌")]),t("a",{staticClass:"btn-fill-main",on:{click:function(t){return a.selectItemBrand(e,n)}}},[a._v("选择品牌")]),a._l(e.brandList,function(s,i){return t("span",{key:i+"brand"+n,staticClass:"btn-small"},[a._v("\n              "+a._s(s.name)),t("a",{staticClass:"delete-icon",on:{click:function(t){return a.removeItemBrand(e,i)}}},[a._v("X")])])})],2),a._e(),a._e(),t("div",{staticClass:"condition-btn"},[t("a",{directives:[{name:"show",rawName:"v-show",value:0===n,expression:"index===0"}],on:{click:function(e){return a.addConditionItem()}}},[a._v("添加")]),t("a",{directives:[{name:"show",rawName:"v-show",value:n>0,expression:"index>0"}],staticClass:"delete-condition",on:{click:function(e){return a.removeConditionItem(n)}}},[a._v("删除")])])])])}),0),t("div",{staticClass:"banner-item"},[t("span",{staticClass:"banner-title"},[a._v("起止时间")]),t("el-date-picker",{staticClass:"timepicker-control",attrs:{size:"small",type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择","picker-options":a.pickerOption},model:{value:a.bannerParams.startTime,callback:function(e){a.$set(a.bannerParams,"startTime",e)},expression:"bannerParams.startTime"}}),t("el-date-picker",{staticClass:"timepicker-control",attrs:{size:"small",type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择","picker-options":a.pickerOption},model:{value:a.bannerParams.endTime,callback:function(e){a.$set(a.bannerParams,"endTime",e)},expression:"bannerParams.endTime"}})],1),t("div",{staticClass:"banner-item"},[t("span",{staticClass:"banner-title"},[a._v("是否启用")]),t("el-radio",{staticClass:"radio",attrs:{label:1},model:{value:a.bannerParams.status,callback:function(e){a.$set(a.bannerParams,"status",e)},expression:"bannerParams.status"}},[a._v("启用")]),t("el-radio",{staticClass:"radio",attrs:{label:0},model:{value:a.bannerParams.status,callback:function(e){a.$set(a.bannerParams,"status",e)},expression:"bannerParams.status"}},[a._v("禁用")])],1)]),t("div",{staticClass:"bot-btn"},[t("a",{staticClass:"btn-main",attrs:{href:"javascript:;"},on:{click:function(e){return a.saveBanner()}}},[a._v("保存")]),t("router-link",{staticClass:"btn-fill-main",attrs:{to:{name:"电脑端"}}},[a._v("返回")])],1),a.showCategoryModal?t("selectCategory",{attrs:{selected:a.selectedCateList},on:{dialogCategory:a.dialogCategory,dialogCategoryCancel:a.dialogCategoryCancel}}):a._e(),a.showBrandModal?t("selectBrand",{attrs:{selected:a.selectedBrandList},on:{dialogBrand:a.dialogBrand,dialogBrandCancel:a.dialogBrandCancel}}):a._e(),a.showCropper?t("Cropper",{ref:"cropper",attrs:{imgUrl:a.bannerParams.imageUrl,fixedNumber:[96,25]},on:{dialogCropper:a.dialogCropper,dialogCropperCancel:a.dialogCropperCancel}}):a._e()],1)},s=[],i=(t("7f7f"),t("ac6a"),t("a4d1")),r=t("8d0f"),o=t("a670"),c={components:{selectCategory:i["a"],selectBrand:r["a"],Cropper:o["a"]},data:function(){return{id:"",showCategoryModal:!1,showBrandModal:!1,showCropper:!1,cateList:[],brandList:[],shopList:[],channelList:[],currentCateItem:-1,selectedCateList:[],currentBrandItem:-1,selectedBrandList:[],pickerOption:{disabledDate:function(a){return a.getTime()<Date.now()-864e5}},jumpTypeList:[{id:25,name:"活动"},{id:24,name:"链接"},{id:31,name:"组合条件"},{id:110,name:"搜索"}],bannerParams:{title:"",jumpType:25,imageUrl:"",startTime:"",endTime:"",status:0,conditionList:[{cateList:[],brandList:[],shopIdList:[],channelTypeList:[]}]}}},created:function(){var a=this;this.id=this.$route.params.id||"",this.api.store.allShop({}).then(function(e){a.shopList=e.data}),this.api.goods.channel({}).then(function(e){a.channelList=e.data}),this.id&&this.getDetail()},methods:{getDetail:function(){var a=this;this.api.category.thirdCate({}).then(function(e){a.cateList=e.data.dataList,a.api.brand.letterList({}).then(function(e){a.brandList=e.data,a.api.system.bannerDetail({id:a.id}).then(function(e){a.bannerParams.id=e.data.id,a.bannerParams.title=e.data.title,a.bannerParams.startTime=e.data.startTime,a.bannerParams.endTime=e.data.endTime,a.bannerParams.status=e.data.status,a.bannerParams.jumpType=e.data.jump.jumpType,a.bannerParams.imageUrl=e.data.imageUrl,31===a.bannerParams.jumpType?(a.bannerParams.conditionList=JSON.parse(e.data.jump.jumpData),a.bannerParams.conditionList.forEach(function(e){a.$set(e,"cateList",[]),a.$set(e,"brandList",[]),e.categoryUnitList.forEach(function(t){a.cateList.forEach(function(a){a.id===t.cateId3&&e.cateList.push({name:a.name,id:a.id})})}),e.brandIdList.forEach(function(t){a.brandList.forEach(function(a){a.id===t&&e.brandList.push(a)})})})):a.bannerParams.jumpData=e.data.jump.jumpData})})})},addConditionItem:function(){this.bannerParams.conditionList.push({cateList:[],brandList:[],shopIdList:[],channelTypeList:[]})},removeConditionItem:function(a){this.bannerParams.conditionList.splice(a,1)},selectItemCate:function(a,e){this.currentCateItem=this.copy(e),this.selectedCateList=a.cateList||[],this.showCategoryModal=!0},removeItemCate:function(a,e){a.cateList.splice(e,1)},openCropperModal:function(){this.showCropper=!0},dialogCropper:function(a){this.bannerParams.imageUrl=a.url,this.showCropper=!1},dialogCropperCancel:function(){this.showCropper=!1},selectItemBrand:function(a,e){this.currentBrandItem=this.copy(e),this.selectedBrandList=a.brandList||[],this.showBrandModal=!0},removeItemBrand:function(a,e){a.brandList.splice(e,1)},dialogCategory:function(a){console.log("res",a),this.currentCateItem>-1?(this.bannerParams.conditionList[this.currentCateItem].cateList=a.categoryList,this.showCategoryModal=!1,this.currentCateItem=-1):this.$message.info({message:"系统错误",showClose:!0})},dialogCategoryCancel:function(){this.showCategoryModal=!1},dialogBrand:function(a){this.currentBrandItem>-1?(this.bannerParams.conditionList[this.currentBrandItem].brandList=a.brandList,this.showBrandModal=!1,this.currentBrandItem=-1):this.$message.info({message:"系统错误",showClose:!0})},dialogBrandCancel:function(){this.showBrandModal=!1},saveBanner:function(){var a=this,e=this.copy(this.bannerParams),t=new Date(e.startTime),n=new Date(e.endTime);if(t>=n)return this.$message.info("结束时间应在开始时间之后"),0;31===e.jumpType?(e.conditionList.forEach(function(a){a.categoryUnitList=[],a.brandIdList=[],a.cateList&&a.cateList.length>0&&a.cateList.forEach(function(e){a.categoryUnitList.push({cateId1:e.firstId,cateId2:e.parentId,cateId3:e.id})}),a.brandList&&a.brandList.length>0&&a.brandList.forEach(function(e){a.brandIdList.push(e.id)}),delete a.cateList,delete a.brandList,delete a.empty}),e.jump={jumpType:e.jumpType,jumpData:e.conditionList}):e.jump={jumpType:e.jumpType,jumpData:e.jumpData},delete e.jumpType,delete e.jumpData,delete e.conditionList,e.jump=JSON.stringify(e.jump),this.console(e),e.id?this.api.system.editBanner(e).then(function(e){a.$message.success({message:e.message,showClose:!0}),a.$router.push({name:"电脑端"})}):this.api.system.addBanner(e).then(function(e){a.$message.success({message:e.message,showClose:!0}),a.$router.push({name:"电脑端"})})}}},l=c,m=(t("4620"),t("2877")),d=Object(m["a"])(l,n,s,!1,null,null,null);e["default"]=d.exports}}]);
//# sourceMappingURL=chunk-2517879c.f570e4f8.js.map